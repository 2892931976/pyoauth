
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using RSA-SHA1 signatures &mdash; pyoauth v0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/minimalism.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pyoauth v0.0.1 documentation" href="../index.html" />
    <link rel="next" title="Contributing" href="hacking.html" />
    <link rel="prev" title="A typical OAuth 1.0 flow in simple words" href="oauth1.html" /> 
  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="using-rsa-sha1-signatures">
<span id="using-rsa-sha1"></span><h1>Using RSA-SHA1 signatures<a class="headerlink" href="#using-rsa-sha1-signatures" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python"><pre>-----BEGIN RSA PRIVATE KEY-----
MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALRiMLAh9iimur8V
A7qVvdqxevEuUkW4K+2KdMXmnQbG9Aa7k7eBjK1S+0LYmVjPKlJGNXHDGuy5Fw/d
7rjVJ0BLB+ubPK8iA/Tw3hLQgXMRRGRXXCn8ikfuQfjUS1uZSatdLB81mydBETlJ
hI6GH4twrbDJCR2Bwy/XWXgqgGRzAgMBAAECgYBYWVtleUzavkbrPjy0T5FMou8H
X9u2AC2ry8vD/l7cqedtwMPp9k7TubgNFo+NGvKsl2ynyprOZR1xjQ7WgrgVB+mm
uScOM/5HVceFuGRDhYTCObE+y1kxRloNYXnx3ei1zbeYLPCHdhxRYW7T0qcynNmw
rn05/KO2RLjgQNalsQJBANeA3Q4Nugqy4QBUCEC09SqylT2K9FrrItqL2QKc9v0Z
zO2uwllCbg0dwpVuYPYXYvikNHHg+aCWF+VXsb9rpPsCQQDWR9TT4ORdzoj+Nccn
qkMsDmzt0EfNaAOwHOmVJ2RVBspPcxt5iN4HI7HNeG6U5YsFBb+/GZbgfBT3kpNG
WPTpAkBI+gFhjfJvRw38n3g/+UeAkwMI2TJQS4n8+hid0uus3/zOjDySH3XHCUno
cn1xOJAyZODBo47E+67R4jV1/gzbAkEAklJaspRPXP877NssM5nAZMU0/O/NGCZ+
3jPgDUno6WbJn5cqm8MqWhW1xGkImgRk+fkDBquiq4gPiT898jusgQJAd5Zrr6Q8
AO/0isr/3aa6O6NLQxISLKcPDk2NOccAfS/xOtfOz4sJYM3+Bs4Io9+dZGSDCA54
Lw03eHTNQghS0A==
-----END RSA PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
 MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0YjCwIfYoprq/FQO6lb3asXrx
 LlJFuCvtinTF5p0GxvQGu5O3gYytUvtC2JlYzypSRjVxwxrsuRcP3e641SdASwfr
 mzyvIgP08N4S0IFzEURkV1wp/IpH7kH41EtbmUmrXSwfNZsnQRE5SYSOhh+LcK2w
 yQkdgcMv11l4KoBkcwIDAQAB
 -----END PUBLIC KEY-----

-----BEGIN CERTIFICATE-----
MIIBpjCCAQ+gAwIBAgIBATANBgkqhkiG9w0BAQUFADAZMRcwFQYDVQQDDA5UZXN0
IFByaW5jaXBhbDAeFw03MDAxMDEwODAwMDBaFw0zODEyMzEwODAwMDBaMBkxFzAV
BgNVBAMMDlRlc3QgUHJpbmNpcGFsMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB
gQC0YjCwIfYoprq/FQO6lb3asXrxLlJFuCvtinTF5p0GxvQGu5O3gYytUvtC2JlY
zypSRjVxwxrsuRcP3e641SdASwfrmzyvIgP08N4S0IFzEURkV1wp/IpH7kH41Etb
mUmrXSwfNZsnQRE5SYSOhh+LcK2wyQkdgcMv11l4KoBkcwIDAQABMA0GCSqGSIb3
DQEBBQUAA4GBAGZLPEuJ5SiJ2ryq+CmEGOXfvlTtEL2nuGtr9PewxkgnOjZpUy+d
4TvuXJbNQc8f4AMWL/tO9w0Fk80rWKp9ea8/df4qMq5qlFWlx6yOLQxumNOmECKb
WpkUQDIDJEoFUzKMVuJf4KO/FJ345+BNLGgbJ6WujreoM1X/gYfdnJ/J
-----END CERTIFICATE-----</pre>
</div>
<div class="section" id="whoa">
<h2>Whoa?!<a class="headerlink" href="#whoa" title="Permalink to this headline">¶</a></h2>
<p>Betchyoo weren&#8217;t expecting that. Ha!</p>
<blockquote>
<div>&#8220;What&#8217;s up with all that gibberish up there, man?&#8221; you ask.</div></blockquote>
<div class="highlight-python"><pre>  ____________________________________
 /                                    \
|                                      |
|   Yeah, dude. I mean, up there! -^   |
|                                      |
 \____________________________________/
                               V
                              You. =O</pre>
</div>
<p>That, my friend, is three friends. Wait, my grammar has left with the wind.</p>
<blockquote>
<div>&#8220;Three friends, huh?&#8221;</div></blockquote>
<p>Yep, three friends. They keep your privates private and your publics... err,
they&#8217;re not really worried about your publics.</p>
<blockquote>
<div>&#8220;Do these friends have names, man?&#8221;</div></blockquote>
<p>Yeah. They&#8217;re:</p>
<ol class="arabic simple">
<li>RSA private key</li>
<li>RSA public key</li>
<li>X.509 certificate</li>
</ol>
<p>They&#8217;re a happy couple.</p>
<blockquote>
<div>&#8220;One. Two. Three. Hmm. Oye, that&#8217;s 3 of them. Couple? So, umm... how do they
work? Somethin&#8217; to do with opensll yeah?&#8221;</div></blockquote>
<p>We&#8217;ll get to this in a bit. Kinda, yes, and that&#8217;s &#8220;OpenSSL,&#8221; by the way.</p>
</div>
<div class="section" id="why-should-you-use-public-key-encryption">
<h2>Why should you use public-key encryption?<a class="headerlink" href="#why-should-you-use-public-key-encryption" title="Permalink to this headline">¶</a></h2>
<p>Because it&#8217;s harder—it&#8217;s harder for an attacker to snoop into your privacy.
Consider two people, say A and B, trying to communicate securely with each
other. What they need to communicate securely are these guarantees:</p>
<ol class="arabic simple">
<li>Ensure that the messages that A and B exchange are <strong>confidential</strong>.</li>
<li>Ensure that the message that B receives from A were <strong>actually sent by A</strong>
and vice versa.</li>
<li>Ensure that the messages that A and B exchange <strong>aren&#8217;t tampered with while
in transit</strong>.</li>
</ol>
<p>Using public-key encryption provides those guarantees. Now, using RSA-SHA-1
signatures shouldn&#8217;t be as difficult as they are to use with OAuth. Therefore,
we have tried to take the burden of implementing it away from you and made
it as easy as possible for you to use this signature method.</p>
<div class="section" id="so-how-does-oauth-use-public-key-encryption">
<h3>So how does OAuth use public-key encryption?<a class="headerlink" href="#so-how-does-oauth-use-public-key-encryption" title="Permalink to this headline">¶</a></h3>
<p>OAuth requires the use of SSL by the clients when requesting token secrets
from OAuth servers. This takes care of the confidential part. The other two
are handled by RSA-SHA-1 signatures.</p>
<p>Imagine public-key encryption as equivalent to having a lock with two
complementary keys—that is, if you lock something with one key, only the
other key can open it. So, RSA public-key encryption uses the notion of these
two keys to secure your messages. Here is what you have to do to use
these keys with OAuth:</p>
<ol class="arabic simple">
<li>You share your public key (an RSA public key or an X.509 public-key
certificate) with the OAuth provider.</li>
<li>Sign your messages with your RSA private key (which you keep safe and don&#8217;t
share with anybody else including the OAuth provider).</li>
<li>The OAuth provider can now use the public key that you shared with it
to verify the messages that you sent to it signed with your private key.</li>
</ol>
<p>That&#8217;s essentially it.</p>
</div>
</div>
<div class="section" id="what-does-a-key-look-like">
<h2>What does a key look like?<a class="headerlink" href="#what-does-a-key-look-like" title="Permalink to this headline">¶</a></h2>
<p>A key can come in multiple formats. The <a class="reference external" href="http://en.wikipedia.org/wiki/Privacy_Enhanced_Mail">PEM</a>, or Privacy Enhanced
electronic-Mail, format is a commonly accepted format, and that is the one
preferred by this library. Keys can be also stored in JSON formats as the one
used by the <a class="reference external" href="http://www.keyczar.org/">Keyczar</a> library. Have a look at the
<a class="reference external" href="http://code.google.com/p/keyczar/wiki/RsaPrivateKey">Keyczar RSA private key format</a>. Public keys that you generate are
generally encoded into something called an X.509 public-key certificate.
You can share either an RSA public key or an X.509 public-key certificate
with your OAuth provider. Providers usually ask for an X.509 public-key
certificate.</p>
<div class="section" id="rsa-private-key">
<h3>RSA Private Key<a class="headerlink" href="#rsa-private-key" title="Permalink to this headline">¶</a></h3>
<p>An example:</p>
<div class="highlight-python"><pre>-----BEGIN RSA PRIVATE KEY-----
MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALRiMLAh9iimur8V
A7qVvdqxevEuUkW4K+2KdMXmnQbG9Aa7k7eBjK1S+0LYmVjPKlJGNXHDGuy5Fw/d
7rjVJ0BLB+ubPK8iA/Tw3hLQgXMRRGRXXCn8ikfuQfjUS1uZSatdLB81mydBETlJ
hI6GH4twrbDJCR2Bwy/XWXgqgGRzAgMBAAECgYBYWVtleUzavkbrPjy0T5FMou8H
X9u2AC2ry8vD/l7cqedtwMPp9k7TubgNFo+NGvKsl2ynyprOZR1xjQ7WgrgVB+mm
uScOM/5HVceFuGRDhYTCObE+y1kxRloNYXnx3ei1zbeYLPCHdhxRYW7T0qcynNmw
rn05/KO2RLjgQNalsQJBANeA3Q4Nugqy4QBUCEC09SqylT2K9FrrItqL2QKc9v0Z
zO2uwllCbg0dwpVuYPYXYvikNHHg+aCWF+VXsb9rpPsCQQDWR9TT4ORdzoj+Nccn
qkMsDmzt0EfNaAOwHOmVJ2RVBspPcxt5iN4HI7HNeG6U5YsFBb+/GZbgfBT3kpNG
WPTpAkBI+gFhjfJvRw38n3g/+UeAkwMI2TJQS4n8+hid0uus3/zOjDySH3XHCUno
cn1xOJAyZODBo47E+67R4jV1/gzbAkEAklJaspRPXP877NssM5nAZMU0/O/NGCZ+
3jPgDUno6WbJn5cqm8MqWhW1xGkImgRk+fkDBquiq4gPiT898jusgQJAd5Zrr6Q8
AO/0isr/3aa6O6NLQxISLKcPDk2NOccAfS/xOtfOz4sJYM3+Bs4Io9+dZGSDCA54
Lw03eHTNQghS0A==
-----END RSA PRIVATE KEY-----</pre>
</div>
</div>
<div class="section" id="rsa-public-key">
<h3>RSA Public Key<a class="headerlink" href="#rsa-public-key" title="Permalink to this headline">¶</a></h3>
<p>An example:</p>
<div class="highlight-python"><pre>-----BEGIN PUBLIC KEY-----
 MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0YjCwIfYoprq/FQO6lb3asXrx
 LlJFuCvtinTF5p0GxvQGu5O3gYytUvtC2JlYzypSRjVxwxrsuRcP3e641SdASwfr
 mzyvIgP08N4S0IFzEURkV1wp/IpH7kH41EtbmUmrXSwfNZsnQRE5SYSOhh+LcK2w
 yQkdgcMv11l4KoBkcwIDAQAB
 -----END PUBLIC KEY-----</pre>
</div>
</div>
<div class="section" id="x-509-public-key-certificate">
<h3>X.509 Public-key Certificate<a class="headerlink" href="#x-509-public-key-certificate" title="Permalink to this headline">¶</a></h3>
<p>An example:</p>
<div class="highlight-python"><pre>-----BEGIN CERTIFICATE-----
MIIBpjCCAQ+gAwIBAgIBATANBgkqhkiG9w0BAQUFADAZMRcwFQYDVQQDDA5UZXN0
IFByaW5jaXBhbDAeFw03MDAxMDEwODAwMDBaFw0zODEyMzEwODAwMDBaMBkxFzAV
BgNVBAMMDlRlc3QgUHJpbmNpcGFsMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB
gQC0YjCwIfYoprq/FQO6lb3asXrxLlJFuCvtinTF5p0GxvQGu5O3gYytUvtC2JlY
zypSRjVxwxrsuRcP3e641SdASwfrmzyvIgP08N4S0IFzEURkV1wp/IpH7kH41Etb
mUmrXSwfNZsnQRE5SYSOhh+LcK2wyQkdgcMv11l4KoBkcwIDAQABMA0GCSqGSIb3
DQEBBQUAA4GBAGZLPEuJ5SiJ2ryq+CmEGOXfvlTtEL2nuGtr9PewxkgnOjZpUy+d
4TvuXJbNQc8f4AMWL/tO9w0Fk80rWKp9ea8/df4qMq5qlFWlx6yOLQxumNOmECKb
WpkUQDIDJEoFUzKMVuJf4KO/FJ345+BNLGgbJ6WujreoM1X/gYfdnJ/J
-----END CERTIFICATE-----</pre>
</div>
</div>
</div>
<div class="section" id="making-your-own-key-pair">
<h2>Making your own key-pair<a class="headerlink" href="#making-your-own-key-pair" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>&#8220;Alright. I get it Sherlock. Now, how do I make my pair of keys
to use with an OAuth provider?&#8221;</div></blockquote>
<p>You can generate your own self-signed X.509 certificate and private RSA key
using the tools OpenSSL provides. You&#8217;ll need <a class="reference external" href="http://www.openssl.org/">OpenSSL</a> installed for the
following command to work at the terminal:</p>
<div class="highlight-python"><pre>$ openssl req -x509 -nodes -days 365 -newkey rsa:1024 -sha1 -keyout \
    rsa_private_key.pem -out x509_public_certificate.pem</pre>
</div>
<p>Answer all the questions that the tool asks and you should be good to go.
For more detailed information about generating X.509 public-key certificates,
read:</p>
<ol class="arabic simple">
<li><a class="reference external" href="http://www.ipsec-howto.org/x595.html">http://www.ipsec-howto.org/x595.html</a></li>
<li><a class="reference external" href="http://www.imacat.idv.tw/tech/sslcerts.html#reqform">http://www.imacat.idv.tw/tech/sslcerts.html#reqform</a></li>
</ol>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using RSA-SHA1 signatures</a><ul>
<li><a class="reference internal" href="#whoa">Whoa?!</a></li>
<li><a class="reference internal" href="#why-should-you-use-public-key-encryption">Why should you use public-key encryption?</a><ul>
<li><a class="reference internal" href="#so-how-does-oauth-use-public-key-encryption">So how does OAuth use public-key encryption?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#what-does-a-key-look-like">What does a key look like?</a><ul>
<li><a class="reference internal" href="#rsa-private-key">RSA Private Key</a></li>
<li><a class="reference internal" href="#rsa-public-key">RSA Public Key</a></li>
<li><a class="reference internal" href="#x-509-public-key-certificate">X.509 Public-key Certificate</a></li>
</ul>
</li>
<li><a class="reference internal" href="#making-your-own-key-pair">Making your own key-pair</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Navigation</h3>
<p>
  <a href="../index.html">Documentation overview</a>
</p>
<ul>
    <li>Previous: <a
      href="oauth1.html"
      title="previous chapter"
    >A typical OAuth 1.0 flow in simple words</a>
    </li>
    <li>Next: <a
      href="hacking.html"
      title="next chapter"
    >Contributing</a>
    </li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/guides/rsa_sha1.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <a href="http://github.com/gorakhargosh/pyoauth">
      <img
        style="position: absolute; top: 0; right: 0; border: 0;"
        src="https://assets2.github.com/img/71eeaab9d563c2b3c590319b398dd35683265e85?repo=&url=http%3A%2F%2Fs3.amazonaws.com%2Fgithub%2Fribbons%2Fforkme_right_gray_6d6d6d.png&path="
        alt="Fork me on GitHub">
    </a>
  

    <div class="footer">
        &copy; Copyright 2011, Yesudeep Mangalapilly.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>